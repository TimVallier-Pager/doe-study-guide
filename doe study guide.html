<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Director of Engineering ‚Äî Interactive Study Hub</title>
  <meta name="description" content="A self-contained, interactive, and flashy study hub to prep for a Director of Engineering role. Includes curated resources, checklists, progress tracking, Pomodoro timer, notes, and export/import.">
  <style>
    /* -----------------------------
       Reset & base
    ------------------------------*/
    *, *::before, *::after { box-sizing: border-box; }
    :root{
      --bg-1: #0b1020; /* deep indigo */
      --bg-2: #0f1a3a; /* midnight blue */
      --fg: #e8eefc;   /* near white */
      --muted: #b6c0e0;
      --accent: #73f3d1; /* aqua */
      --accent-2: #a98bff; /* purple */
      --accent-3: #ff7ad9; /* pink */
      --card: rgba(255,255,255,0.07);
      --card-strong: rgba(255,255,255,0.12);
      --border: rgba(255,255,255,0.16);
      --ok: #6be675;
      --warn: #ffd166;
      --bad: #ff7a7a;
      --shadow: 0 8px 30px rgba(0,0,0,0.35);
      --radius: 16px;
    }
    [data-theme="light"]{
      --bg-1: #f6f8ff;
      --bg-2: #f0f4ff;
      --fg: #0e1330;
      --muted: #364168;
      --card: rgba(0,0,0,0.05);
      --card-strong: rgba(0,0,0,0.08);
      --border: rgba(0,0,0,0.12);
      --shadow: 0 6px 22px rgba(0,0,0,0.12);
    }
    html, body { height: 100%; }
    body{
      margin:0; color:var(--fg); background: radial-gradient(1200px 1200px at 0% 0%, #1b2a6b 0%, var(--bg-1) 40%),
                                       radial-gradient(1000px 900px at 100% 0%, #221253 0%, var(--bg-2) 45%),
                                       radial-gradient(1200px 900px at 100% 100%, #162645 0%, var(--bg-1) 40%),
                                       radial-gradient(1000px 1200px at 0% 100%, #1b214a 0%, var(--bg-2) 40%);
      font-family: ui-sans-serif, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Apple Color Emoji, Segoe UI Emoji;
      line-height: 1.4;
      overflow: hidden; /* app layout */
    }
    a { color: var(--accent); text-decoration: none; }
    a:hover { text-decoration: underline; }

    /* -----------------------------
       App layout
    ------------------------------*/
    .app{
      display:grid; grid-template-columns: 320px 1fr; height:100vh;
      gap: 0; position: relative;
    }
    .sidebar{
      border-right:1px solid var(--border);
      backdrop-filter: blur(8px);
      background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
      padding: 18px 16px 12px; overflow:auto;
    }
    .main{
      overflow:auto; position: relative;
    }

    /* Floating gradient blobs for flashiness */
    .blob{ position:absolute; inset:auto; pointer-events:none; filter: blur(50px); opacity:.45; mix-blend-mode: screen; }
    .blob.b1{ width:520px; height:520px; background: radial-gradient(circle at 30% 30%, var(--accent), transparent 60%);
      right:-120px; top:-120px; animation: float1 18s ease-in-out infinite; }
    .blob.b2{ width:440px; height:440px; background: radial-gradient(circle at 70% 70%, var(--accent-2), transparent 60%);
      left:-120px; bottom:-120px; animation: float2 22s ease-in-out infinite; }
    .blob.b3{ width:380px; height:380px; background: radial-gradient(circle at 50% 50%, var(--accent-3), transparent 60%);
      right:10%; bottom:20%; animation: float3 26s ease-in-out infinite; }
    @keyframes float1 { 0%,100%{ transform: translateY(0) translateX(0); } 50%{ transform: translateY(40px) translateX(-20px) scale(1.05);} }
    @keyframes float2 { 0%,100%{ transform: translateY(0) translateX(0);} 50%{ transform: translateY(-35px) translateX(25px) scale(0.95);} }
    @keyframes float3 { 0%,100%{ transform: translateY(0) translateX(0);} 50%{ transform: translateY(25px) translateX(-30px) scale(1.08);} }

    /* -----------------------------
       Sidebar
    ------------------------------*/
    .logo{ display:flex; align-items:center; gap:10px; font-weight: 800; letter-spacing:.3px; }
    .logo .badge{ padding:4px 8px; border-radius:999px; background: linear-gradient(45deg, var(--accent-2), var(--accent-3)); color:#0b0b14; font-weight:900; text-transform:uppercase; font-size:12px; }

    .bar{ margin-top:14px; background: var(--card); border:1px solid var(--border); border-radius: var(--radius); padding:10px; box-shadow: var(--shadow); }
    .bar h4{ margin:6px 6px 8px; color: var(--muted); font-weight:700; font-size:12px; letter-spacing:.8px; text-transform: uppercase; }
    .search{ display:flex; gap:8px; padding:6px; background: var(--card-strong); border-radius: 12px; border:1px solid var(--border); }
    .search input{ width:100%; background:transparent; border:none; outline:none; color:var(--fg); font-size:14px; }

    .toggles{ display:flex; gap:8px; flex-wrap:wrap; }
    .chip{ border:1px solid var(--border); background: var(--card); padding:6px 10px; border-radius: 999px; font-size:12px; cursor:pointer; user-select:none; }
    .chip.is-on{ background: linear-gradient(45deg, rgba(115,243,209,.2), rgba(169,139,255,.2)); border-color: transparent; }

    .tools{ display:grid; grid-template-columns: 1fr 1fr; gap:8px; }
    .btn{ display:inline-flex; align-items:center; justify-content:center; gap:8px; padding:10px 12px; font-weight:700; border-radius: 12px; border:1px solid var(--border); background: var(--card); cursor:pointer; }
    .btn:hover{ transform: translateY(-1px); }

    .nav{ margin-top:12px; display:flex; flex-direction:column; gap:6px; }
    .nav a{ display:flex; align-items:center; gap:8px; padding:10px 12px; border-radius: 12px; border:1px solid transparent; background: transparent; color: var(--fg); }
    .nav a:hover{ background: var(--card); border-color: var(--border); text-decoration:none; }
    .nav a.active{ background: linear-gradient(180deg, rgba(115,243,209,0.12), rgba(169,139,255,0.12)); border-color: transparent; }

    .meter{ height:10px; border-radius:8px; background: var(--card); border:1px solid var(--border); overflow:hidden; }
    .meter > span{ display:block; height:100%; width:0%; background: linear-gradient(90deg, var(--accent), var(--accent-3)); transition: width .3s ease; }
    .meta-row{ display:flex; align-items:center; justify-content:space-between; gap:8px; font-size:12px; color:var(--muted); }

    /* -----------------------------
       Main / hero
    ------------------------------*/
    header.hero{
      position: sticky; top:0; z-index:5;
      padding: 18px 24px; border-bottom:1px solid var(--border);
      background: linear-gradient(180deg, rgba(10,10,30,0.75), rgba(10,10,30,0.35)); backdrop-filter: blur(6px);
      display:flex; align-items:center; justify-content:space-between; gap:16px;
    }
    .hero h1{ margin:0; font-size: clamp(18px, 2.2vw, 28px); letter-spacing:.3px; }
    .hero .minitext{ color:var(--muted); font-size:12px; }

    .content{ padding: 28px; display:grid; gap: 24px; }
    section{ scroll-margin-top: 88px; }

    .section-title{ display:flex; align-items:baseline; gap:12px; }
    .section-title h2{ margin:0; font-size: clamp(18px, 2.2vw, 24px); }
    .section-title .tag{ font-size:11px; letter-spacing:.8px; color:var(--muted); text-transform: uppercase; border:1px solid var(--border); padding:4px 8px; border-radius:999px; }

    .grid{ display:grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap:16px; }
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.03));
      border:1px solid var(--border); border-radius: var(--radius);
      padding:14px; box-shadow: var(--shadow); position: relative; overflow:hidden;
    }
    .card .kicker{ font-size:11px; color:var(--muted); letter-spacing:.6px; text-transform:uppercase; }
    .card h3{ margin:6px 0 8px; font-size:18px; }
    .card p{ margin:0; color:var(--muted); font-size:14px; }
    .pill{ display:inline-flex; gap:6px; align-items:center; padding:4px 8px; border-radius:999px; border:1px solid var(--border); font-size:12px; }
    .row{ display:flex; align-items:center; justify-content:space-between; gap:8px; margin-top:10px; }
    .row .left, .row .right{ display:flex; align-items:center; gap:8px; flex-wrap: wrap; }
    .row .right .btn{ padding:8px 10px; }

    .check{ appearance:none; width:22px; height:22px; border-radius:6px; border:1px solid var(--border); background: var(--card); cursor:pointer; position:relative; }
    .check:checked{ background: linear-gradient(135deg, var(--accent), var(--accent-2)); border-color: transparent; }
    .check:checked::after{ content:"‚úì"; position:absolute; inset:0; display:flex; align-items:center; justify-content:center; font-weight:900; color:#07121b; }

    .notes{ margin-top:10px; }
    .notes textarea{ width:100%; min-height:80px; background: var(--card); color: var(--fg); border:1px solid var(--border); border-radius:12px; padding:10px; resize:vertical; }

    .small{ font-size:12px; color: var(--muted); }

    .kbd{ padding:2px 6px; border-radius:6px; background: var(--card); border:1px solid var(--border); font-size:12px; }

    .template{ white-space: pre-wrap; background: var(--card); border:1px solid var(--border); border-radius:12px; padding:12px; }

    /* Pomodoro */
    .pomodoro{ display:grid; gap:10px; grid-template-columns: 1fr; }
    .pomodoro .display{ font-size: 28px; font-weight: 800; letter-spacing: 2px; text-align:center; padding:8px; border-radius:12px; border:1px solid var(--border); background: var(--card); }
    .pomodoro .controls{ display:flex; gap:8px; }
    .pomodoro input{ width:100%; background: transparent; border:1px solid var(--border); color: var(--fg); border-radius: 10px; padding:8px 10px; }

    /* Footer */
    footer{ text-align:center; color:var(--muted); padding: 40px 10px; }

    /* Tooltips */
    [data-tip]{ position:relative; }
    [data-tip]:hover::after{
      content: attr(data-tip);
      position:absolute; left:50%; transform: translateX(-50%);
      bottom: calc(100% + 8px); white-space:nowrap; font-size:11px; color:#07121b; background:#e8eefc; padding:4px 8px; border-radius:6px; box-shadow: var(--shadow);
    }

    /* Responsive */
    @media (max-width: 880px){
      .app{ grid-template-columns: 1fr; }
      .sidebar{ position: sticky; top:0; z-index: 50; }
    }
  </style>
</head>
<body>
  <div class="app" id="app">
    <aside class="sidebar">
      <div class="logo">
        <svg width="26" height="26" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M3 12c0-4.97 4.03-9 9-9s9 4.03 9 9-4.03 9-9 9" stroke="url(#g)" stroke-width="2"/>
          <path d="M6 12a6 6 0 1 1 12 0c0 3.314-2.686 6-6 6" stroke="url(#g)" stroke-width="2"/>
          <path d="M9 12a3 3 0 1 1 6 0c0 1.657-1.343 3-3 3" stroke="url(#g)" stroke-width="2"/>
          <defs>
            <linearGradient id="g" x1="0" y1="0" x2="24" y2="24">
              <stop stop-color="var(--accent)"/>
              <stop offset="1" stop-color="var(--accent-2)"/>
            </linearGradient>
          </defs>
        </svg>
        <div>
          <div>Director Study Hub</div>
          <div class="badge">DoE</div>
        </div>
      </div>

      <div class="bar" aria-label="Search and Filters">
        <h4>Find resources</h4>
        <div class="search" role="search">
          <span>üîé</span>
          <input id="search" placeholder="Search title, tags, week, type‚Ä¶ ( / )" autocomplete="off"/>
        </div>
        <div class="toggles" style="margin-top:10px">
          <div class="chip" data-filter="Book">Book</div>
          <div class="chip" data-filter="Talk">Talk</div>
          <div class="chip" data-filter="Article">Article</div>
          <div class="chip" data-filter="Podcast">Podcast</div>
          <div class="chip" data-filter="Guide">Guide</div>
          $1
          <div class=\"chip\" data-filter=\"Repo\">Repo<\/div>
        </div>
      </div>

      <div class="bar" aria-label="Tools">
        <h4>Tools</h4>
        <div class="tools">
          <button class="btn" id="themeToggle" data-tip="Toggle light/dark (T)">üåì Theme</button>
          <button class="btn" id="shuffle" data-tip="Shuffle suggestions (S)">üé≤ Shuffle</button>
          <button class="btn" id="exportBtn" data-tip="Export progress">‚¨áÔ∏è Export</button>
          <label class="btn" for="importFile" data-tip="Import progress">‚¨ÜÔ∏è Import<input id="importFile" type="file" accept="application/json" hidden></label>
        </div>
        <div style="margin-top:10px; display:grid; gap:6px;">
          <div class="meta-row"><span>Overall Progress</span><span id="progressPct">0%</span></div>
          <div class="meter" aria-hidden="true"><span id="meterFill"></span></div>
        </div>
      </div>

      <div class="bar" aria-label="Navigation">
        <h4>Sections</h4>
        <nav class="nav" id="toc"></nav>
      </div>

      <div class="bar" aria-label="Pomodoro">
        <h4>Study Timer</h4>
        <div class="pomodoro">
          <div class="display" id="pomoDisplay">25:00</div>
          <div class="controls">
            <button class="btn" id="startPomo">‚ñ∂ Start</button>
            <button class="btn" id="pausePomo">‚è∏ Pause</button>
            <button class="btn" id="resetPomo">‚Ü∫ Reset</button>
          </div>
          <div style="display:grid; grid-template-columns: 1fr 1fr; gap:8px;">
            <label class="small">Focus (min)
              <input id="focusLen" type="number" min="1" value="25">
            </label>
            <label class="small">Break (min)
              <input id="breakLen" type="number" min="1" value="5">
            </label>
          </div>
          <div class="small">Tip: it notifies at 0:00 and auto-switches focus/break. üîî</div>
        </div>
      </div>

      <div class="bar" aria-label="Shortcuts">
        <h4>Shortcuts</h4>
        <div class="small">Press <span class="kbd">/</span> to search, <span class="kbd">T</span> theme, <span class="kbd">S</span> shuffle, <span class="kbd">G</span> top.</div>
      </div>
    </aside>

    <main class="main" id="main">
      <div class="blob b1"></div>
      <div class="blob b2"></div>
      <div class="blob b3"></div>

      <header class="hero">
        <div>
          <h1>Director of Engineering ‚Äî Interactive Study Hub</h1>
          <div class="minitext">A curated, 6‚Äëweek prep with progress tracking, notes, and tools. Links open in new tabs.</div>
        </div>
        <div class="row">
          <span class="pill">‚ú® Flashy Mode On</span>
          <button class="btn" id="clearAll">üßπ Clear Progress</button>
        </div>
      </header>

      <div class="content" id="content">
        <!-- Dynamic content will be rendered here -->
      </div>

      <footer>
        Built as a single HTML file. No external dependencies. Save this page and study offline. üí™
      </footer>
    </main>
  </div>

  <script>
    // -----------------------------
    // Resource data (curated syllabus)
    // -----------------------------
    const RESOURCES = [
      // Week 1 ‚Äî Role reset & first 90 days
      {id:'w1-r1', week:1, type:'Book', title:'The First 90 Days (Michael Watkins)', why:'Transition playbook‚Äîadapt for an internal promotion.', link:'https://www.google.com/search?q=The+First+90+Days+Michael+Watkins'},
      {id:'w1-r2', week:1, type:'Book', title:'High Output Management (Andy Grove)', why:'Operating cadence, leverage, staff meetings & 1:1s.', link:'https://www.google.com/search?q=High+Output+Management+Andy+Grove'},

      // Week 2 ‚Äî Strategy you can execute
      {id:'w2-r1', week:2, type:'Talk', title:'Solving the Engineering Strategy Crisis (Will Larson)', why:'What strategy is and how to drive it.', link:'https://www.google.com/search?q=Solving+the+Engineering+Strategy+Crisis+Will+Larson'},
      {id:'w2-r2', week:2, type:'Book', title:'An Elegant Puzzle (Will Larson)', why:'Org design, migrations, debt, sizing teams.', link:'https://www.google.com/search?q=An+Elegant+Puzzle+Will+Larson'},
      {id:'w2-r3', week:2, type:'Book', title:"The Engineering Executive‚Äôs Primer (Will Larson)", why:'Headcount planning, exec metrics, comms.', link:'https://www.google.com/search?q=The+Engineering+Executive%E2%80%99s+Primer+Will+Larson'},

      // Week 3 ‚Äî Org design & team interfaces
      {id:'w3-r1', week:3, type:'Book', title:'Team Topologies (2nd ed.)', why:'Team types & interaction modes for clean boundaries.', link:'https://www.google.com/search?q=Team+Topologies+2nd+edition'},
      {id:'w3-r2', week:3, type:'Video', title:'LeadDev ‚Äî Managing Managers', why:'Practical talks on manager-of-managers patterns.', link:'https://www.google.com/search?q=LeadDev+managing+managers'},
      {id:'w3-r3', week:3, type:'Video', title:'LeadDev ‚Äî Onboarding Tech Leads', why:'Help new leads ramp with clear interfaces.', link:'https://www.google.com/search?q=LeadDev+onboarding+tech+leads'},

      // Week 4 ‚Äî Goals, execution, and metrics
      {id:'w4-r1', week:4, type:'Guide', title:'OKRs Explained (WhatMatters.com)', why:'How to frame outcomes and common pitfalls.', link:'https://www.whatmatters.com/'},
      {id:'w4-r2', week:4, type:'Guide', title:'LeadDev ‚Äî OKR Guides', why:'Org adoption patterns and anti-patterns.', link:'https://www.google.com/search?q=LeadDev+OKR+guide'},
      {id:'w4-r3', week:4, type:'Article', title:'DORA ‚Äî State of DevOps (2024+)', why:'Delivery+DevEx metrics that matter.', link:'https://dora.dev/'},
      {id:'w4-r4', week:4, type:'Article', title:'SPACE Framework (ACM/Queue)', why:'Measure productivity holistically.', link:'https://www.google.com/search?q=SPACE+framework+ACM+Queue'},

      // Week 5 ‚Äî Managing managers & talent systems
      {id:'w5-r1', week:5, type:'Book', title:"The Manager‚Äôs Path (Camille Fournier)", why:'Manager-of-managers, calibrations, org health.', link:'https://www.google.com/search?q=The+Manager%E2%80%99s+Path+Camille+Fournier'},
      {id:'w5-r2', week:5, type:'Book', title:'Resilient Management (Lara Hogan)', why:'Coaching, feedback, trust & psychological safety.', link:'https://larahogan.me/books/resilient-management/'},
      {id:'w5-r3', week:5, type:'Guide', title:'Progression.fyi ‚Äî Career Ladders', why:'Reference ladders to refine your own.', link:'https://www.progression.fyi/'},

      // Week 6 ‚Äî Cross-functional leadership, comms & incidents
      {id:'w6-r1', week:6, type:'Video', title:'LeadDev ‚Äî Executing Technical Strategy at Scale', why:'Planning, roadmaps, and OKR sync.', link:'https://www.google.com/search?q=LeadDev+executing+technical+strategy+at+scale'},
      {id:'w6-r2', week:6, type:'Guide', title:'Google SRE ‚Äî Practical Incident Response', why:'Blameless reviews, on-call, production standards.', link:'https://sre.google/books/'},
      {id:'w6-r3', week:6, type:'Guide', title:'PagerDuty ‚Äî Incident Response Docs', why:'Run consistent incidents and postmortems.', link:'https://www.google.com/search?q=PagerDuty+Incident+Response+Documentation'},
      {id:'w6-r4', week:6, type:'Article', title:"Charity Majors on o11y & platforms", why:'Modern, pragmatic perspectives on DevEx.', link:'https://charity.wtf/'},

      // Listen while you commute
      {id:'pod-1', week:'Podcasts', type:'Podcast', title:'ELC ‚Äî Engineering Leadership Podcast', why:'Interviews with VPs/CTOs on scaling & strategy.', link:'https://www.google.com/search?q=ELC+Engineering+Leadership+Podcast'},
      {id:'pod-2', week:'Podcasts', type:'Podcast', title:'Dev Interrupted', why:'DevEx, productivity & leading teams.', link:'https://www.google.com/search?q=Dev+Interrupted+podcast'},

      // Checklists & Templates
      {id:'tpl-1', week:'Templates', type:'Template', title:'30/60/90 Plan ‚Äî Director', why:'Land a clean transition with measurable milestones.', link:'#template-3090'},
      {id:'tpl-2', week:'Templates', type:'Template', title:'Director Operating System (DOS)', why:'Your cadence: staff, metrics, roadmap, incidents.', link:'#template-dos'},

      // Optional but timely
      {id:'opt-1', week:'Optional', type:'Article', title:'DORA 2024 ‚Äî Platform Engineering Highlights', why:'Use data to back DevEx/platform investments.', link:'https://dora.dev/research/'},
      // GitHub Lists ‚Äî Curated Reading
      {id:'gh-1', week:'GitHub', type:'Repo', title:'charlax/engineering-management', why:'Long-running, high-signal reading list for EM & tech leadership.', link:'https://github.com/charlax/engineering-management'},
      {id:'gh-2', week:'GitHub', type:'Repo', title:'engineering-management/awesome-engineering-management', why:'"Awesome" pointers & tools for day-to-day EM practice.', link:'https://github.com/engineering-management/awesome-engineering-management'},
      {id:'gh-3', week:'GitHub', type:'Repo', title:'kdeldycke/awesome-engineering-team-management', why:'Deep curation for transitioning to EM and managing managers.', link:'https://github.com/kdeldycke/awesome-engineering-team-management'},
      {id:'gh-4', week:'GitHub', type:'Repo', title:'andrablaj/engineering-management-handbook', why:'Practical handbook of links & templates from a practicing EM.', link:'https://github.com/andrablaj/engineering-management-handbook'},
      {id:'gh-5', week:'GitHub', type:'Repo', title:'gregorojstersek/resources-to-become-a-great-engineering-leader', why:'100+ resources (books, newsletters, people) tuned for 2025.', link:'https://github.com/gregorojstersek/resources-to-become-a-great-engineering-leader'},
      {id:'gh-6', week:'GitHub', type:'Repo', title:'jamescarr/awesome-engineering-management', why:'Compact awesome list of EM links & classics.', link:'https://github.com/jamescarr/awesome-engineering-management'},
      {id:'gh-7', week:'GitHub', type:'Repo', title:'aleixmorgadas/awesome-engineering-strategy', why:'Resources on crafting & executing engineering strategy.', link:'https://github.com/aleixmorgadas/awesome-engineering-strategy'},
      {id:'gh-8', week:'GitHub', type:'Repo', title:'reiver/technology-executive-reading-list', why:'VP/CTO-leaning reading list (useful context at Director level).', link:'https://github.com/reiver/technology-executive-reading-list'},
      {id:'gh-9', week:'GitHub', type:'Repo', title:'staffeng42/awesome-staff-plus-engineering', why:'Staff+ leadership resources to partner well with senior ICs.', link:'https://github.com/staffeng42/awesome-staff-plus-engineering'},
      {id:'gh-10', week:'GitHub', type:'Repo', title:'ryanburgess/engineer-manager', why:'Popular EM resources list by Netflix EM Ryan Burgess.', link:'https://github.com/ryanburgess/engineer-manager'},
      {id:'gh-11', week:'GitHub', type:'Repo', title:"ostronom/awesome-engineering-managers-handbook", why:'Articles, newsletters, interviewing & tools for EMs.', link:'https://github.com/ostronom/awesome-engineering-managers-handbook'},
      {id:'gh-12', week:'GitHub', type:'Repo', title:'tech-leads-club/awesome-tech-lead', why:'Tech-lead focused curation‚Äîuseful when managing TLs.', link:'https://github.com/tech-leads-club/awesome-tech-lead'}
    ];

    // Section manifest with order
    const SECTIONS = [
      { id:'week1',  label:'Week 1 ‚Äî Role Reset & First 90 Days',  filter:(r)=>r.week===1 },
      { id:'week2',  label:'Week 2 ‚Äî Strategy You Can Execute',     filter:(r)=>r.week===2 },
      { id:'week3',  label:'Week 3 ‚Äî Org Design & Interfaces',     filter:(r)=>r.week===3 },
      { id:'week4',  label:'Week 4 ‚Äî Goals, Execution & Metrics',  filter:(r)=>r.week===4 },
      { id:'week5',  label:'Week 5 ‚Äî Managing Managers & Talent',  filter:(r)=>r.week===5 },
      { id:'week6',  label:'Week 6 ‚Äî XFN, Comms & Incidents',      filter:(r)=>r.week===6 },
      { id:'gh',     label:'GitHub Lists ‚Äî Curated Reading',        filter:(r)=>r.week==='GitHub' },
      { id:'pods',   label:'Podcasts ‚Äî Listen on the Move',        filter:(r)=>r.week==='Podcasts' },
      { id:'temps',  label:'Checklists & Templates',               filter:(r)=>r.week==='Templates' },
      { id:'opt',    label:'Optional ‚Äî 2025‚Äëtimely',               filter:(r)=>r.week==='Optional' },
    ];

    // -----------------------------
    // Helpers: state, storage, utils
    // -----------------------------
    const ls = {
      get(k, fallback){ try{ const v = localStorage.getItem(k); return v? JSON.parse(v) : fallback; }catch{ return fallback; } },
      set(k, v){ try{ localStorage.setItem(k, JSON.stringify(v)); }catch{} }
    };
    const state = {
      done: ls.get('doe_done', {}),
      notes: ls.get('doe_notes', {}),
      theme: ls.get('doe_theme', 'dark'),
      filters: ls.get('doe_filters', []),
      focusLen: ls.get('doe_focus', 25),
      breakLen: ls.get('doe_break', 5)
    };

    function $(sel, root=document){ return root.querySelector(sel); }
    function $all(sel, root=document){ return Array.from(root.querySelectorAll(sel)); }

    function createEl(tag, attrs={}, html=''){
      const el = document.createElement(tag);
      Object.entries(attrs).forEach(([k,v])=>{
        if(k==='class') el.className=v; else if(k==='dataset') Object.assign(el.dataset,v); else if(k==='for') el.htmlFor=v; else el.setAttribute(k,v);
      });
      el.innerHTML = html; return el;
    }

    function updateProgress(){
      const total = RESOURCES.length;
      const doneCt = Object.values(state.done).filter(Boolean).length;
      const pct = Math.round((doneCt/total)*100);
      $('#progressPct').textContent = pct + '%';
      $('#meterFill').style.width = pct + '%';
      document.title = `DoE Study Hub ‚Äî ${pct}%`;
    }

    function confettiSplash(x=window.innerWidth/2, y=120){
      const c = document.createElement('canvas');
      c.style.position='fixed'; c.style.left='0'; c.style.top='0'; c.style.width='100%'; c.style.height='100%'; c.style.pointerEvents='none'; c.width=window.innerWidth; c.height=window.innerHeight; document.body.appendChild(c);
      const ctx = c.getContext('2d');
      const pieces = Array.from({length: 180}, ()=>({
        x, y, r: Math.random()*6+3, vx:(Math.random()-0.5)*6, vy: Math.random()*-6-4, ay: 0.18+Math.random()*0.1,
        col: ['#73f3d1','#a98bff','#ff7ad9','#ffd166','#6be675'][Math.floor(Math.random()*5)], life: 0, spin: Math.random()*6
      }));
      let t=0; (function frame(){ t++; ctx.clearRect(0,0,c.width,c.height);
        pieces.forEach(p=>{ p.vy += p.ay; p.x+=p.vx; p.y+=p.vy; p.life+=1; p.spin+=0.2; ctx.save(); ctx.translate(p.x, p.y); ctx.rotate(p.spin); ctx.fillStyle=p.col; ctx.fillRect(-p.r/2,-p.r/2,p.r,p.r); ctx.restore(); });
        if(t<180){ requestAnimationFrame(frame);} else { c.remove(); }
      })();
    }

    // -----------------------------
    // Render sections & cards
    // -----------------------------
    function render(){
      const content = $('#content'); content.innerHTML='';
      const q = ($('#search').value || '').trim().toLowerCase();
      const typeFilters = new Set(state.filters);

      SECTIONS.forEach(sec=>{
        const items = RESOURCES.filter(sec.filter).filter(r=>{
          const hit = (r.title+" "+r.why+" "+r.type+" Week "+r.week).toLowerCase().includes(q);
          const typeOk = typeFilters.size? typeFilters.has(r.type) : true;
          return hit && typeOk;
        });
        if(!items.length) return;

        const section = createEl('section', {id: sec.id});
        const title = createEl('div', {class:'section-title'});
        title.appendChild(createEl('h2', {}, sec.label));
        title.appendChild(createEl('span', {class:'tag'}, `${items.length} item${items.length>1?'s':''}`));
        section.appendChild(title);

        const grid = createEl('div', {class:'grid'});
        items.forEach(r=>{
          const card = createEl('article', {class:'card', id:r.id});
          const kicker = createEl('div', {class:'kicker'}, r.type);
          const h3 = createEl('h3', {}, r.title);
          const p = createEl('p', {}, r.why);

          const row = createEl('div', {class:'row'});
          const left = createEl('div', {class:'left'});
          const right = createEl('div', {class:'right'});

          const weekPill = createEl('span', {class:'pill'}, `Week ${r.week?.toString().padStart? r.week.toString().padStart(2,'0') : r.week}`);
          const done = createEl('input', {type:'checkbox', class:'check'});
          done.checked = !!state.done[r.id];
          done.addEventListener('change', ()=>{
            state.done[r.id] = done.checked; ls.set('doe_done', state.done); updateProgress();
            if(done.checked){ const box = card.getBoundingClientRect(); confettiSplash(box.left+box.width/2, box.top+20); }
          });

          left.appendChild(weekPill);
          left.appendChild(createEl('span', {class:'pill'}, r.type));
          left.appendChild(done);

          const open = createEl('a', {class:'btn', href:r.link, target:'_blank', rel:'noopener noreferrer'}, 'üîó Open');
          const noteBtn = createEl('button', {class:'btn'}, 'üìù Notes');

          right.appendChild(open);
          right.appendChild(noteBtn);

          row.appendChild(left); row.appendChild(right);

          const notesWrap = createEl('div', {class:'notes', style:'display:none;'});
          const ta = createEl('textarea', {placeholder:'Your notes‚Ä¶'});
          ta.value = state.notes[r.id] || '';
          ta.addEventListener('input', ()=>{ state.notes[r.id]=ta.value; ls.set('doe_notes', state.notes); });
          notesWrap.appendChild(ta);

          noteBtn.addEventListener('click', ()=>{ notesWrap.style.display = notesWrap.style.display==='none'?'block':'none'; });

          card.appendChild(kicker); card.appendChild(h3); card.appendChild(p); card.appendChild(row); card.appendChild(notesWrap);
          grid.appendChild(card);
        });
        section.appendChild(grid);

        // Templates (special anchors)
        if(sec.id==='temps'){
          const t1 = createEl('div', {class:'template', id:'template-3090'});
          t1.textContent = `30/60/90 ‚Äî Director Plan\n\n30 days ‚Äî Map & Listen\n‚Ä¢ Org map: teams, charters, owners, risks\n‚Ä¢ Portfolio: in-flight bets, dependencies, deadlines\n‚Ä¢ Health: on-call, incidents, quality signals, morale\n‚Ä¢ Cadence draft: staff meeting, metrics review, roadmap sync\n‚Ä¢ Stakeholder 1:1s: product, design, data, GTM, finance\n\n60 days ‚Äî Decide & Document\n‚Ä¢ Engineering Strategy: context ‚Üí diagnosis ‚Üí guiding policy ‚Üí bets\n‚Ä¢ Headcount plan: hiring freezes, moves, succession, backfills\n‚Ä¢ DevEx initiatives: top 2 bottlenecks (data-backed) with owners\n‚Ä¢ Operating model: RACI for roadmap/OKR planning & incident mgmt\n\n90 days ‚Äî Land & Improve\n‚Ä¢ Publish DOS (Director Operating System)\n‚Ä¢ Lock OKRs with measures (DORA/SPACE + business)\n‚Ä¢ Run incident/postmortem ritual; share learnings org-wide\n‚Ä¢ Review ladders & expectations; start calibrations\n‚Ä¢ Communicate results & next 90d bets`; 

          const t2 = createEl('div', {class:'template', id:'template-dos'});
          t2.textContent = `Director Operating System (DOS)\n\nCadences\n‚Ä¢ Weekly staff: metrics (10m), portfolio (15m), risks (10m), people (10m)\n‚Ä¢ Monthly deep-dive: strategy/bets review with product/design\n‚Ä¢ Quarterly plan: OKRs & resourcing with finance & recruiting\n\nMetrics (review monthly)\n‚Ä¢ Delivery: DORA (lead time, deploy freq, CFR, MTTR)\n‚Ä¢ DevEx: SPACE (satisfaction survey, flow metrics)\n‚Ä¢ Business: north-star(s) that eng influences\n\nPeople Systems\n‚Ä¢ Expectations for managers (1:1s, performance notes, hiring bars)\n‚Ä¢ Ladder alignment (reference progression.fyi)\n‚Ä¢ Talent reviews & succession plan\n\nIncidents\n‚Ä¢ Blameless reviews; owners; action items with due dates\n‚Ä¢ Reliability budgets/SLIs; incident comms template\n\nComms\n‚Ä¢ Monthly eng newsletter (wins, learnings, risks, hiring)\n‚Ä¢ 1‚Äëpage strategy (Rumelt kernel): context ‚Üí diagnosis ‚Üí guiding policy ‚Üí bets/roadmap\n\nTemplates\n‚Ä¢ RFC header, postmortem doc, runbook skeleton, hiring packet`;

          const wrap = createEl('div', {class:'grid'});
          wrap.appendChild(createEl('article',{class:'card'}, `<div class="kicker">Template</div><h3>30/60/90 Plan</h3><p>Copy, tweak, and share with your VP.</p><div class="row"><div class="left"><span class="pill">Template</span></div><div class="right"><button class="btn" data-copy="#template-3090">üìã Copy</button></div></div><div class="notes">${t1.outerHTML}</div>`));
          wrap.appendChild(createEl('article',{class:'card'}, `<div class="kicker">Template</div><h3>Director Operating System</h3><p>Your steady drumbeat for running the org.</p><div class="row"><div class="left"><span class="pill">Template</span></div><div class="right"><button class="btn" data-copy="#template-dos">üìã Copy</button></div></div><div class="notes">${t2.outerHTML}</div>`));
          section.appendChild(wrap);
        }

        $('#content').appendChild(section);
      });

      // Build TOC
      const toc = $('#toc'); toc.innerHTML='';
      SECTIONS.forEach(sec=>{
        const a = createEl('a', {href:'#'+sec.id}, `<span>‚Ä¢</span><span>${sec.label}</span>`);
        toc.appendChild(a);
      });

      // Attach copy handlers for templates
      $all('[data-copy]').forEach(b=>{
        b.addEventListener('click', ()=>{
          const sel = b.getAttribute('data-copy'); const el = $(sel);
          navigator.clipboard.writeText(el.textContent).then(()=>{ b.textContent='‚úÖ Copied'; setTimeout(()=>b.textContent='üìã Copy', 1500); });
        });
      });

      updateProgress();
    }

    // -----------------------------
    // Filtering & chips
    // -----------------------------
    function wireFilters(){
      const chips = $all('.chip');
      function sync(){ chips.forEach(c=> c.classList.toggle('is-on', state.filters.includes(c.dataset.filter))); }
      chips.forEach(ch=>{
        ch.addEventListener('click', ()=>{
          const t = ch.dataset.filter; const i = state.filters.indexOf(t);
          if(i>=0) state.filters.splice(i,1); else state.filters.push(t);
          ls.set('doe_filters', state.filters); sync(); render();
        });
      });
      sync();
    }

    // -----------------------------
    // Theme toggle
    // -----------------------------
    function applyTheme(){
      document.documentElement.setAttribute('data-theme', state.theme==='light'?'light':'dark');
    }

    // -----------------------------
    // Shuffle suggestions
    // -----------------------------
    function shuffleArray(arr){ for(let i=arr.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]]; } }
    function handleShuffle(){ shuffleArray(RESOURCES); render(); confettiSplash(); }

    // -----------------------------
    // Export/Import
    // -----------------------------
    function exportProgress(){
      const data = { done: state.done, notes: state.notes, filters: state.filters, theme: state.theme, focusLen: state.focusLen, breakLen: state.breakLen };
      const blob = new Blob([JSON.stringify(data,null,2)], {type:'application/json'});
      const url = URL.createObjectURL(blob); const a = document.createElement('a');
      a.href=url; a.download='doe-study-progress.json'; a.click(); URL.revokeObjectURL(url);
    }
    function importProgress(file){
      const reader = new FileReader(); reader.onload = () => {
        try{ const data = JSON.parse(reader.result);
          state.done = data.done || {}; state.notes = data.notes || {}; state.filters = data.filters || []; state.theme = data.theme || state.theme;
          state.focusLen = data.focusLen || 25; state.breakLen = data.breakLen || 5;
          ls.set('doe_done', state.done); ls.set('doe_notes', state.notes); ls.set('doe_filters', state.filters); ls.set('doe_theme', state.theme);
          ls.set('doe_focus', state.focusLen); ls.set('doe_break', state.breakLen);
          applyTheme(); render();
        }catch{ alert('Could not import JSON.'); }
      }; reader.readAsText(file);
    }

    // -----------------------------
    // Pomodoro timer
    // -----------------------------
    let timer=null, leftSec=0, onBreak=false;
    function fmt(n){ return String(Math.floor(n)).padStart(2,'0'); }
    function updatePomo(){ $('#pomoDisplay').textContent = `${fmt(Math.floor(leftSec/60))}:${fmt(leftSec%60)}`; }
    function tick(){ if(leftSec<=0){
        // switch
        onBreak = !onBreak; leftSec = (onBreak? state.breakLen : state.focusLen) * 60; updatePomo();
        // notify
        confettiSplash();
        try{ const ctx = new (window.AudioContext||window.webkitAudioContext)(); const o=ctx.createOscillator(); const g=ctx.createGain(); o.type='triangle'; o.frequency.value=520; o.connect(g); g.connect(ctx.destination); g.gain.setValueAtTime(0.0001, ctx.currentTime); g.gain.exponentialRampToValueAtTime(0.4, ctx.currentTime+0.05); o.start(); setTimeout(()=>{ g.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime+0.3); o.stop(ctx.currentTime+0.35); }, 250);
        }catch{}
        document.title = (onBreak? '‚òï Break ‚Äî ' : '‚è± Focus ‚Äî ') + document.title.replace(/^((‚è±|‚òï) (Focus|Break) ‚Äî )?/,'');
        return;
      }
      leftSec--; updatePomo();
    }
    function startPomo(){ if(timer) return; if(leftSec<=0){ leftSec = state.focusLen * 60; onBreak=false; } timer = setInterval(tick, 1000); document.title = '‚è± Focus ‚Äî ' + document.title.replace(/^((‚è±|‚òï) (Focus|Break) ‚Äî )?/,''); }
    function pausePomo(){ if(timer){ clearInterval(timer); timer=null; } }
    function resetPomo(){ pausePomo(); leftSec = state.focusLen*60; onBreak=false; updatePomo(); document.title = document.title.replace(/^((‚è±|‚òï) (Focus|Break) ‚Äî )?/, ''); }

    // -----------------------------
    // Scroll spy
    // -----------------------------
    function scrollSpy(){ const y=window.scrollY; let activeId=null; SECTIONS.forEach(sec=>{ const el=$('#'+sec.id); if(!el) return; const top=el.getBoundingClientRect().top + window.scrollY; if(top-100 <= y) activeId=sec.id; });
      $all('.nav a').forEach(a=> a.classList.toggle('active', a.getAttribute('href')==='#'+activeId)); }

    // -----------------------------
    // Wire up UI
    // -----------------------------
    window.addEventListener('DOMContentLoaded', ()=>{
      applyTheme();
      // Controls
      $('#themeToggle').addEventListener('click', ()=>{ state.theme = (state.theme==='dark'?'light':'dark'); ls.set('doe_theme', state.theme); applyTheme(); confettiSplash(); });
      $('#shuffle').addEventListener('click', handleShuffle);
      $('#exportBtn').addEventListener('click', exportProgress);
      $('#importFile').addEventListener('change', (e)=> e.target.files[0] && importProgress(e.target.files[0]));
      $('#clearAll').addEventListener('click', ()=>{ if(confirm('Clear all progress & notes?')){ state.done={}; state.notes={}; ls.set('doe_done',{}); ls.set('doe_notes',{}); render(); } });
      $('#search').addEventListener('input', render);
      document.addEventListener('keydown', (e)=>{
        if(e.key==='/' && document.activeElement!==$('#search')){ e.preventDefault(); $('#search').focus(); }
        if(e.key.toLowerCase()==='t'){ e.preventDefault(); $('#themeToggle').click(); }
        if(e.key.toLowerCase()==='s'){ e.preventDefault(); $('#shuffle').click(); }
        if(e.key.toLowerCase()==='g'){ window.scrollTo({top:0, behavior:'smooth'}); }
      });

      // Pomodoro controls
      $('#focusLen').value = state.focusLen; $('#breakLen').value = state.breakLen; updatePomo();
      $('#focusLen').addEventListener('change', ()=>{ state.focusLen = Math.max(1, parseInt($('#focusLen').value)||25); ls.set('doe_focus', state.focusLen); resetPomo(); });
      $('#breakLen').addEventListener('change', ()=>{ state.breakLen = Math.max(1, parseInt($('#breakLen').value)||5); ls.set('doe_break', state.breakLen); resetPomo(); });
      $('#startPomo').addEventListener('click', startPomo);
      $('#pausePomo').addEventListener('click', pausePomo);
      $('#resetPomo').addEventListener('click', resetPomo);

      render(); wireFilters(); scrollSpy();
      window.addEventListener('scroll', scrollSpy, {passive:true});
    });
  </script>
</body>
</html>
